<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>UPP: FDLVL.f File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">UPP
   &#160;<span id="projectnumber">10.0.11</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Types&#160;List</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('FDLVL_8f.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">FDLVL.f File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><a href="FDLVL_8f_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ac1dedeeda1cfd828301f619da3880cbb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="FDLVL_8f.html#ac1dedeeda1cfd828301f619da3880cbb">FDLVL</a> (ITYPE, TFD, QFD, UFD, VFD, PFD, ICINGFD, AERFD)</td></tr>
<tr class="memdesc:ac1dedeeda1cfd828301f619da3880cbb"><td class="mdescLeft">&#160;</td><td class="mdescRight">SUBPROGRAM: FDLVL COMPUTES FD LEVEL T, Q, U, V PRGRMMR: TREADON ORG: W/NP2 DATE: 92-12-22.  <a href="#ac1dedeeda1cfd828301f619da3880cbb">More...</a><br/></td></tr>
<tr class="separator:ac1dedeeda1cfd828301f619da3880cbb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50d7ed4613cc246037b302a2387841b1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a50d7ed4613cc246037b302a2387841b1"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>FDLVL_MASS</b> (ITYPE, NFD, PTFD, HTFD, NIN, QIN, QTYPE, QFD)</td></tr>
<tr class="separator:a50d7ed4613cc246037b302a2387841b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad19b75c33450267785e72e6f1f8dc4e3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad19b75c33450267785e72e6f1f8dc4e3"></a>
subroutine&#160;</td><td class="memItemRight" valign="bottom"><b>FDLVL_UV</b> (ITYPE, NFD, HTFD, UFD, VFD)</td></tr>
<tr class="separator:ad19b75c33450267785e72e6f1f8dc4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a class="anchor" id="ac1dedeeda1cfd828301f619da3880cbb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine FDLVL </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(nfd), intent(in)&#160;</td>
          <td class="paramname"><em>ITYPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>TFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>QFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>UFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>VFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>PFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd), intent(out)&#160;</td>
          <td class="paramname"><em>ICINGFD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ista:iend,jsta:jend,nfd,nbin_du), intent(out)&#160;</td>
          <td class="paramname"><em>AERFD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>SUBPROGRAM: FDLVL COMPUTES FD LEVEL T, Q, U, V PRGRMMR: TREADON ORG: W/NP2 DATE: 92-12-22. </p>
<p>ABSTRACT: THIS ROUTINE COMPUTES TEMPERATURE, SPEC. HUM, U WIND COMPONENT, AND V WIND COMPONENT ON THE NFD=6 FD LEVELS. THE HEIGHT OF THESE LEVELS (IN METERS) IS GIVEN IN THE DATA STATEMENT BELOW. THE ALGORITHM PROCEEDS AS FOLLOWS. (AGL IN PARENTHESES)</p>
<p>AT EACH MASS POINT MOVE UP VERTICALLY FROM THE LM-TH (LOWEST ATMOSPHERIC) ETA LAYER. FIND THE ETA LAYERS WHOSE HEIGHT (ABOVE GROUND) BOUNDS THE TARGET FD LEVEL HEIGHT. VERTICALLY INTERPOLATE TO GET TEMPERATURE AT THIS FD LEVEL. AVERAGE THE FOUR SURROUNDING WINDS TO GET A MASS POINT WIND. VERTICALLY INTERPOLATE THESE MASS POINT WINDS TO THE TARGET FD LEVEL. CONTINUE THIS PROCESS UNTIL ALL NFD=6 FD LEVELS HAVE BEEN PROCESSED. MOVE ON TO THE NEXT MASS POINT.</p>
<p>AVERAGING THE FOUR ABOVE GROUND WINDS TO THE MASS POINT WAS FOUND TO SMOOTH THE FIELD AND REDUCE THE OCCURRENCE OF POINT PEAK WINDS FAR IN EXCESS OF THE WINDS AT ADJACENT POINTS. MASS POINT VALUES ARE RETURNED.</p>
<p>PROGRAM HISTORY LOG: 92-12-22 RUSS TREADON 93-11-23 RUSS TREADON - CORRECTED ROUTINE TO COMPUTE FD LEVELS WITH REPECT TO MEAN SEA LEVEL. 94-01-04 MICHAEL BALDWIN - INCLUDE OPTIONS FOR COMPUTING EITHER AGL OR MSL 98-06-15 T BLACK - CONVERSION FROM 1-D TO 2-D 00-01-04 JIM TUCCILLO - MPI VERSION 02-01-15 MIKE BALDWIN - WRF VERSION 11-12-14 SARAH LU - ADD GOCART AEROSOL AERFD 21-10-15 JESSE MENG - 2D DECOMPOSITION</p>
<p>USAGE: CALL FDLVL(ITYPE,TFD,QFD,UFD,VFD) INPUT ARGUMENT LIST: ITYPE - FLAG THAT DETERMINES WHETHER MSL (1) OR AGL (2) LEVELS ARE USED.</p>
<p>OUTPUT ARGUMENT LIST: TFD - TEMPERATURE (K) ON FD LEVELS. QFD - SPEC HUM ON FD LEVELS. UFD - U WIND (M/S) ON FD LEVELS. VFD - V WIND (M/S) ON FD LEVELS.</p>
<p>OUTPUT FILES: NONE</p>
<p>SUBPROGRAMS CALLED: UTILITIES:</p>
<p>LIBRARY: COMMON - LOOPS MASKS OPTIONS INDX</p>
<p>ATTRIBUTES: LANGUAGE: FORTRAN MACHINE : CRAY C-90 </p>

<p>Definition at line <a class="el" href="FDLVL_8f_source.html#l00070">70</a> of file <a class="el" href="FDLVL_8f_source.html">FDLVL.f</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_d8b772108138bf796aaa3f7fe4e09294.html">sorc</a></li><li class="navelem"><a class="el" href="dir_29f0049402def9fd0d109199f2d306c2.html">ncep_post.fd</a></li><li class="navelem"><a class="el" href="FDLVL_8f.html">FDLVL.f</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
